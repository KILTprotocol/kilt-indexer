# To improve query performance, we strongly suggest adding indexes to any field that you plan to filter or sort by
# Add the `@index` or `@index(unique: true)` annotation after any non-key field
# https://academy.subquery.network/build/graphql.html#indexing-by-non-primary-key-field

type Block @entity {
  id: ID! # Block Hash as a string of a hexadecimal number
  number: BigInt! @index # Block Ordinal Number from genesis block
  createdDate: Date! # Date of creation of this block
}

type Attestation @entity {
  id: ID! # event id, i.e.: block number and event index
  claimHash: String! @index # ClaimHashOf, can be duplicated
  valid: Boolean!
  createdDate: Date! # date of creation of the attestation
  createdBlock: BigInt! # block of creation of the attestation
  createdBlockHash: String! # block hash as hex string
  creator: String! # Account address
  attester: String! # DID of the attester
  cType: String! # Id of the CType used in this attestation. A.k.a.: cTypeHash
  delegationID: String
  revokedDate: Date
  revokedBlock: BigInt
  removedDate: Date
  removedBlock: BigInt
}

type Aggregation @entity {
  # This is an entity allowing us to calculate all the attestations created and revoked per CType
  id: ID! #id is CType hash
  attestationsCreated: Int!
  attestationsRevoked: Int!
  attestationsRemoved: Int!
}

# Work in Progress:
type NewAttestation @entity {
  id: ID! # event id, i.e.: block number and event index
  claimHash: String! @index # ClaimHashOf, can be duplicated
  cType: String! # Id of the CType used in this attestation. A.k.a.: cTypeHash
  attester: String! # DID of the attester
  payer: String! # Account address
  delegationID: String
  valid: Boolean!
  creationBlock: Block!
  revocationBlock: Block
  removalBlock: Block
}

type NewAggregation @entity {
  # This is an entity allowing us to calculate all the attestations created and revoked per CType
  id: ID! #id is CType hash
  attestationsCreated: [Attestation]! # Array has to at least be define as []
  attestationsRevoked: [Attestation]!
  attestationsRemoved: [Attestation]!
  countOfAttestationsCreated: Int!
  countOfAttestationsRevoked: Int!
  countOfAttestationsRemoved: Int!
}
